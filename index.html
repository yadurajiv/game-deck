<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameDeck - Ideation Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; }
        .font-serif { font-family: 'Crimson Text', serif; }
        
        /* Card Animations */
        .card-container {
            perspective: 1000px;
        }
        
        .card-enter {
            animation: cardEnter 0.3s ease-out forwards;
        }
        
        .card-discard-left {
            animation: discardLeft 0.3s ease-in forwards;
        }
        
        .card-keep-right {
            animation: keepRight 0.3s ease-in forwards;
        }
        
        .card-reshuffle {
            animation: reshuffle 0.4s ease-in-out;
        }

        @keyframes cardEnter {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes discardLeft {
            to { opacity: 0; transform: translateX(-100%) rotate(-15deg); }
        }

        @keyframes keepRight {
            to { opacity: 0; transform: translateX(100%) rotate(15deg); }
        }

        @keyframes reshuffle {
            0% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0); }
        }

        /* Scrollbar hiding for cleaner look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-900 h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Sidebar -->
    <div class="bg-slate-900 text-slate-300 w-full md:w-64 flex-shrink-0 flex flex-col border-b md:border-r border-slate-700 z-50">
        <div class="p-4 border-b border-slate-800 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i data-lucide="layers" class="text-indigo-400"></i>
                <h1 class="font-bold text-white tracking-wide">GameDeck</h1>
            </div>
            <span class="text-xs bg-indigo-900 text-indigo-300 px-2 py-0.5 rounded-full">v3.0</span>
        </div>

        <!-- Navigation -->
        <nav class="flex md:flex-col p-2 space-x-1 md:space-x-0 md:space-y-1 overflow-x-auto no-scrollbar">
            <button onclick="app.setView('draw')" id="nav-draw" class="flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-slate-800 w-full text-left">
                <i data-lucide="sparkles" class="mr-2 w-4 h-4"></i> Draw
            </button>
            <button onclick="app.setView('saved')" id="nav-saved" class="flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-slate-800 w-full text-left">
                <i data-lucide="save" class="mr-2 w-4 h-4"></i> Saved Hand 
                <span id="saved-count" class="ml-auto bg-slate-800 px-2 rounded-full text-xs">0</span>
            </button>
            <button onclick="app.setView('gallery')" id="nav-gallery" class="flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-slate-800 w-full text-left">
                <i data-lucide="grid" class="mr-2 w-4 h-4"></i> Gallery
            </button>
        </nav>

        <!-- Deck Settings -->
        <div class="mt-auto p-4 border-t border-slate-800 hidden md:block overflow-y-auto no-scrollbar max-h-64">
            <h3 class="text-xs font-bold uppercase text-slate-500 mb-3 tracking-wider">Active Decks</h3>
            <div class="space-y-2">
                <button onclick="app.toggleDeck(1)" id="btn-deck-1" class="w-full flex items-center justify-between p-2 rounded border text-sm border-slate-700 text-slate-500 transition-colors">
                    <span>1. Creative Ways</span>
                    <div class="indicator w-2 h-2 rounded-full bg-indigo-500 hidden"></div>
                </button>
                <button onclick="app.toggleDeck(2)" id="btn-deck-2" class="w-full flex items-center justify-between p-2 rounded border text-sm border-slate-700 text-slate-500 transition-colors">
                    <span>2. Adv. Mechanics</span>
                    <div class="indicator w-2 h-2 rounded-full bg-indigo-500 hidden"></div>
                </button>
                <button onclick="app.toggleDeck(3)" id="btn-deck-3" class="w-full flex items-center justify-between p-2 rounded border text-sm border-slate-700 text-slate-500 transition-colors">
                    <span>3. Aesthetics</span>
                    <div class="indicator w-2 h-2 rounded-full bg-indigo-500 hidden"></div>
                </button>
                <button onclick="app.toggleDeck(4)" id="btn-deck-4" class="w-full flex items-center justify-between p-2 rounded border text-sm border-slate-700 text-slate-500 transition-colors">
                    <span>4. World & Setting</span>
                    <div class="indicator w-2 h-2 rounded-full bg-indigo-500 hidden"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 relative overflow-y-auto bg-slate-100 p-4 md:p-8" id="main-content">
        <!-- Views will be injected here -->
    </main>

    <!-- Templates -->
    
    <!-- Draw View Template -->
    <template id="tpl-draw">
        <div class="h-full flex flex-col items-center justify-center max-w-lg mx-auto w-full">
            <div class="mb-6 text-center">
                <span id="deck-label" class="text-xs font-bold uppercase tracking-widest text-slate-400">Combined Deck</span>
                <p id="card-counter" class="text-slate-500 text-sm mt-1">Card 1 of 50</p>
                <p class="text-xs text-indigo-400 mt-2 flex items-center justify-center gap-2 opacity-70">
                    <span>‚Üê Discard</span> ‚Ä¢ <span>Keep ‚Üí</span> ‚Ä¢ <span>‚Üì Reshuffle</span>
                </p>
            </div>

            <div id="card-wrapper" class="card-container w-72 h-96 relative touch-none select-none">
                <!-- Card render here -->
            </div>

            <div class="flex gap-4 mt-8 w-full max-w-xs">
                <button onclick="app.discard()" class="flex-1 flex flex-col items-center justify-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md hover:bg-slate-50 transition-all group">
                    <i data-lucide="trash-2" class="text-slate-400 group-hover:text-red-500 mb-1"></i>
                    <span class="text-xs font-bold text-slate-500">Discard</span>
                </button>

                <button onclick="app.keep()" class="flex-1 flex flex-col items-center justify-center p-4 bg-indigo-600 rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-500 hover:shadow-indigo-300 transition-all transform hover:-translate-y-1">
                    <i data-lucide="save" class="text-white mb-1"></i>
                    <span class="text-xs font-bold text-white">Keep</span>
                </button>
            </div>
            
            <button onclick="app.reshuffle()" class="mt-8 flex items-center text-slate-400 hover:text-indigo-600 text-xs font-bold uppercase tracking-widest transition-colors">
                <i data-lucide="refresh-cw" class="mr-2 w-3 h-3"></i> Reshuffle Deck
            </button>
        </div>
    </template>

    <!-- Saved View Template -->
    <template id="tpl-saved">
        <div class="max-w-5xl mx-auto w-full">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-bold text-slate-800">Your Hand</h2>
                <button onclick="app.clearSaved()" class="text-red-500 text-sm font-medium hover:text-red-700 flex items-center">
                    <i data-lucide="trash-2" class="mr-1 w-4 h-4"></i> Clear All
                </button>
            </div>
            <div id="saved-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Saved cards injected here -->
            </div>
            <div id="empty-state" class="hidden text-center py-20 border-2 border-dashed border-slate-300 rounded-xl">
                <div class="text-4xl mb-4">üì≠</div>
                <p class="text-slate-500 font-medium">No cards saved yet.</p>
                <button onclick="app.setView('draw')" class="text-indigo-600 font-bold text-sm mt-2 hover:underline">Go draw some!</button>
            </div>
        </div>
    </template>

    <!-- Gallery View Template -->
    <template id="tpl-gallery">
        <div class="max-w-6xl mx-auto pb-10 w-full">
            <h2 class="text-2xl font-bold text-slate-800 mb-8">Full Deck Gallery</h2>
            <div id="gallery-content">
                <!-- Gallery Groups Injected Here -->
            </div>
        </div>
    </template>

    <script>
        // --- Data ---
        // DECK 1: Creative Ways
        const DECK_1 = [
            { id: '1-h2', deck: 1, suit: 'hearts', rank: '2', visual: 'üïπÔ∏è', title: 'Combine Games', concept: 'Mix aspects from different games.', example: 'Monopoly GO! (Monopoly + Coin Master)' },
            { id: '1-h3', deck: 1, suit: 'hearts', rank: '3', visual: 'üåÄ', title: 'Mix Elements', concept: 'Blend mechanics for hybrid synergy.', example: 'SSSnaker (Snake + Archero)' },
            { id: '1-h4', deck: 1, suit: 'hearts', rank: '4', visual: 'üåê', title: 'Simplify', concept: 'Simplify mid-core for casuals.', example: 'Free Fire (PUBG Mobile)' },
            { id: '1-h5', deck: 1, suit: 'hearts', rank: '5', visual: '‚öôÔ∏è', title: 'Improve Concepts', concept: 'Polish unpolished genres.', example: 'Lethal Company (Co-op Horror)' },
            { id: '1-h6', deck: 1, suit: 'hearts', rank: '6', visual: 'üîÑ', title: 'Adapt Platform', concept: 'Transfer to new platforms.', example: 'Stumble Guys (Mobile Fall Guys)' },
            { id: '1-h7', deck: 1, suit: 'hearts', rank: '7', visual: 'ü§™', title: 'Absurdity', concept: 'Combine the unexpected.', example: 'Palworld (Pok√©mon + Guns)' },
            { id: '1-h8', deck: 1, suit: 'hearts', rank: '8', visual: 'üé•', title: 'Iconic Moments', concept: 'Famous scenes as gameplay.', example: 'SUPERHOT (Matrix)' },
            { id: '1-h9', deck: 1, suit: 'hearts', rank: '9', visual: 'üì∫', title: 'Fake Ads', concept: 'Make fake ads real.', example: 'Project Makeover' },
            { id: '1-h10', deck: 1, suit: 'hearts', rank: '10', visual: 'üè∞', title: 'History', concept: 'Rich cultural themes.', example: 'Kingdom Come: Deliverance' },
            { id: '1-hj', deck: 1, suit: 'hearts', rank: 'J', visual: '‚ù§Ô∏è', title: 'Emotions', concept: 'Evoke specific feelings.', example: 'Journey' },
            { id: '1-hq', deck: 1, suit: 'hearts', rank: 'Q', visual: 'üß©', title: '4th Wall', concept: 'Meta-narratives.', example: 'The Stanley Parable' },
            { id: '1-hk', deck: 1, suit: 'hearts', rank: 'K', visual: 'üöÄ', title: 'New Tech', concept: 'Leverage emerging tech.', example: 'Beat Saber (VR)' },
            { id: '1-ha', deck: 1, suit: 'hearts', rank: 'A', visual: 'üåü', title: 'Fantasies', concept: 'Fulfill childhood dreams.', example: 'Sea of Thieves (Pirates)' },
            { id: '1-s2', deck: 1, suit: 'spades', rank: '2', visual: 'üõ†Ô∏è', title: 'Game Mods', concept: 'Mods into standalone.', example: 'Dota 2' },
            { id: '1-s3', deck: 1, suit: 'spades', rank: '3', visual: 'üåç', title: 'Real Life', concept: 'Everyday sensations.', example: 'Papers, Please' },
            { id: '1-s4', deck: 1, suit: 'spades', rank: '4', visual: 'üîÑ', title: 'Inversion', concept: 'Flip the norm.', example: 'Choo-Choo Charles' },
            { id: '1-s5', deck: 1, suit: 'spades', rank: '5', visual: 'üé≤', title: 'Tabletop', concept: 'Board games to digital.', example: 'Among Us (Mafia)' },
            { id: '1-s6', deck: 1, suit: 'spades', rank: '6', visual: 'üîÑ', title: 'Role Reversal', concept: 'Control world, not hero.', example: 'Loop Hero' },
            { id: '1-s7', deck: 1, suit: 'spades', rank: '7', visual: '‚è≥', title: 'Game Jams', concept: 'Strict constraints.', example: 'Goat Simulator' },
            { id: '1-s8', deck: 1, suit: 'spades', rank: '8', visual: 'üîß', title: 'Reverse Engineer', concept: 'Fix genre frustrations.', example: 'Stardew Valley' },
            { id: '1-s9', deck: 1, suit: 'spades', rank: '9', visual: 'üìñ', title: 'Proc. Story', concept: 'Generated narrative arcs.', example: 'Wildermyth' },
            { id: '1-s10', deck: 1, suit: 'spades', rank: '10', visual: 'üçå', title: 'Physics Comedy', concept: 'Wobbly physics humor.', example: 'Human: Fall Flat' },
            { id: '1-sj', deck: 1, suit: 'spades', rank: 'J', visual: 'üéµ', title: 'Rhythm Action', concept: 'Rhythm in non-music genres.', example: 'Crypt of the NecroDancer' },
            { id: '1-sq', deck: 1, suit: 'spades', rank: 'Q', visual: 'üè≠', title: 'Automation', concept: 'Complex engineering.', example: 'Factorio' },
            { id: '1-sk', deck: 1, suit: 'spades', rank: 'K', visual: 'üñºÔ∏è', title: 'Art Gameplay', concept: 'Visual medium as mechanic.', example: 'Gorogoa' },
            { id: '1-sa', deck: 1, suit: 'spades', rank: 'A', visual: 'ü¶á', title: 'Audio Nav', concept: 'See with sound.', example: 'Dark Echo' },
            { id: '1-d2', deck: 1, suit: 'diamonds', rank: '2', visual: '‚öñÔ∏è', title: 'Asymmetric', concept: 'Teams of different sizes.', example: 'Dead by Daylight' },
            { id: '1-d3', deck: 1, suit: 'diamonds', rank: '3', visual: '‚è≥', title: 'Time Control', concept: 'Rewind/Pause time.', example: 'Braid' },
            { id: '1-d4', deck: 1, suit: 'diamonds', rank: '4', visual: 'üëÅÔ∏è', title: 'Perspective', concept: 'Optical illusions.', example: 'Superliminal' },
            { id: '1-d5', deck: 1, suit: 'diamonds', rank: '5', visual: 'üß†', title: 'Knowledge', concept: 'Player levels up, not char.', example: 'Outer Wilds' },
            { id: '1-d6', deck: 1, suit: 'diamonds', rank: '6', visual: '‚ùÑÔ∏è', title: 'Moral Survival', concept: 'Impossible ethical choices.', example: 'Frostpunk' },
            { id: '1-d7', deck: 1, suit: 'diamonds', rank: '7', visual: 'üíÄ', title: 'High Lethality', concept: 'One-hit kills.', example: 'Hotline Miami' },
            { id: '1-d8', deck: 1, suit: 'diamonds', rank: '8', visual: 'üßõ', title: 'Reverse Bullet Hell', concept: 'You are the swarm.', example: 'Vampire Survivors' },
            { id: '1-d9', deck: 1, suit: 'diamonds', rank: '9', visual: 'üíª', title: 'UI Narrative', concept: 'Game in an OS.', example: 'Hypnospace Outlaw' },
            { id: '1-d10', deck: 1, suit: 'diamonds', rank: '10', visual: 'üï∞Ô∏è', title: 'Alt History', concept: 'Change one event.', example: 'Wolfenstein' },
            { id: '1-dj', deck: 1, suit: 'diamonds', rank: 'J', visual: '‚ö°', title: 'Modern Myth', concept: 'Myths with modern vibes.', example: 'Hades' },
            { id: '1-dq', deck: 1, suit: 'diamonds', rank: 'Q', visual: '‚òï', title: 'Cozy', concept: 'Low stakes, high comfort.', example: 'Unpacking' },
            { id: '1-dk', deck: 1, suit: 'diamonds', rank: 'K', visual: 'üö™', title: 'Liminal Horror', concept: 'Empty, familiar spaces.', example: 'The Exit 8' },
            { id: '1-da', deck: 1, suit: 'diamonds', rank: 'A', visual: '‚öΩ', title: 'Sports Hybrid', concept: 'Sport + Absurdity.', example: 'Rocket League' },
            { id: '1-c2', deck: 1, suit: 'clubs', rank: '2', visual: 'üó£Ô∏è', title: 'Non-Violent', concept: 'Conflict via dialogue.', example: 'Disco Elysium' },
            { id: '1-c3', deck: 1, suit: 'clubs', rank: '3', visual: 'üè†', title: 'Env. Narrative', concept: 'Story via objects.', example: 'Edith Finch' },
            { id: '1-c4', deck: 1, suit: 'clubs', rank: '4', visual: 'üß±', title: 'Destruction', concept: 'Breaking is solving.', example: 'Teardown' },
            { id: '1-c5', deck: 1, suit: 'clubs', rank: '5', visual: 'üèóÔ∏è', title: 'Construction', concept: 'Build tools to solve.', example: 'Besiege' },
            { id: '1-c6', deck: 1, suit: 'clubs', rank: '6', visual: 'üìé', title: 'Unfolding Idle', concept: 'Clicker reveals story.', example: 'Universal Paperclips' },
            { id: '1-c7', deck: 1, suit: 'clubs', rank: '7', visual: 'üî¥', title: 'Streamer API', concept: 'Chat affects game.', example: 'Cult of the Lamb' },
            { id: '1-c8', deck: 1, suit: 'clubs', rank: '8', visual: '‚å®Ô∏è', title: 'Typing', concept: 'Typing as combat.', example: 'Typing of the Dead' },
            { id: '1-c9', deck: 1, suit: 'clubs', rank: '9', visual: 'üé®', title: 'Color', concept: 'Matching colors mechanics.', example: 'Splatoon' },
            { id: '1-c10', deck: 1, suit: 'clubs', rank: '10', visual: 'üåå', title: 'Gravity', concept: 'Change gravity direction.', example: 'Gravity Rush' },
            { id: '1-cj', deck: 1, suit: 'clubs', rank: 'J', visual: 'üñ•Ô∏è', title: 'Prog. Logic', concept: 'Write code to automate.', example: 'Baba Is You' },
            { id: '1-cq', deck: 1, suit: 'clubs', rank: 'Q', visual: 'üì∏', title: 'Photography', concept: 'Camera as weapon.', example: 'Pokemon Snap' },
            { id: '1-ck', deck: 1, suit: 'clubs', rank: 'K', visual: 'üêú', title: 'Living World', concept: 'World runs itself.', example: 'Dwarf Fortress' },
            { id: '1-ca', deck: 1, suit: 'clubs', rank: 'A', visual: 'ü™ø', title: 'Stealth Comedy', concept: 'Mischief not murder.', example: 'Untitled Goose Game' },
            { id: '1-joker', deck: 1, suit: 'joker', rank: '‚òÖ', visual: 'üéûÔ∏è', title: 'Nostalgia', concept: 'Draw on beloved past media.', example: 'Cuphead' },
        ];

        // DECK 2: Advanced Mechanics
        const DECK_2 = [
            { id: '2-h2', deck: 2, suit: 'hearts', rank: '2', visual: 'ü§ù', title: 'Companion', concept: 'AI partner bond.', example: 'BioShock Infinite' },
            { id: '2-h3', deck: 2, suit: 'hearts', rank: '3', visual: '‚öîÔ∏è', title: 'Rival', concept: 'Recurring antagonist.', example: 'Pok√©mon' },
            { id: '2-h4', deck: 2, suit: 'hearts', rank: '4', visual: 'üë•', title: 'Ensemble', concept: 'Group dynamics.', example: 'Mass Effect' },
            { id: '2-h5', deck: 2, suit: 'hearts', rank: '5', visual: 'ü§•', title: 'Unreliable', concept: 'Lying narrator.', example: 'Spec Ops: The Line' },
            { id: '2-h6', deck: 2, suit: 'hearts', rank: '6', visual: '‚ôæÔ∏è', title: 'Time Loop', concept: 'Relive and learn.', example: '12 Minutes' },
            { id: '2-h7', deck: 2, suit: 'hearts', rank: '7', visual: 'üîç', title: 'Whodunit', concept: 'Solve a crime.', example: 'Obra Dinn' },
            { id: '2-h8', deck: 2, suit: 'hearts', rank: '8', visual: 'üíò', title: 'Romance', concept: 'Relationships.', example: 'Stardew Valley' },
            { id: '2-h9', deck: 2, suit: 'hearts', rank: '9', visual: 'üé≠', title: 'Tragedy', concept: 'Loss and sacrifice.', example: 'Last of Us Part II' },
            { id: '2-h10', deck: 2, suit: 'hearts', rank: '10', visual: 'ü§°', title: 'Satire', concept: 'Social commentary.', example: 'Helldivers 2' },
            { id: '2-hj', deck: 2, suit: 'hearts', rank: 'J', visual: 'üò∂', title: 'Silent Hero', concept: 'Player projection.', example: 'Half-Life' },
            { id: '2-hq', deck: 2, suit: 'hearts', rank: 'Q', visual: '‚öñÔ∏è', title: 'Moral Gray', concept: 'No good or evil.', example: 'Witcher 3' },
            { id: '2-hk', deck: 2, suit: 'hearts', rank: 'K', visual: 'üå≤', title: 'Branching', concept: 'Massive variations.', example: 'Detroit: Become Human' },
            { id: '2-ha', deck: 2, suit: 'hearts', rank: 'A', visual: 'üé¨', title: 'Director AI', concept: 'Dynamic pacing.', example: 'Left 4 Dead 2' },
            { id: '2-s2', deck: 2, suit: 'spades', rank: '2', visual: 'üÉè', title: 'Deckbuilder', concept: 'Card-based combat.', example: 'Slay the Spire' },
            { id: '2-s3', deck: 2, suit: 'spades', rank: '3', visual: 'üöÅ', title: 'Extraction', concept: 'High stakes escape.', example: 'Tarkov' },
            { id: '2-s4', deck: 2, suit: 'spades', rank: '4', visual: 'üõ°Ô∏è', title: 'Parry', concept: 'Defense is offense.', example: 'Sekiro' },
            { id: '2-s5', deck: 2, suit: 'spades', rank: '5', visual: 'ü•ä', title: 'Combo', concept: 'Chain attacks.', example: 'Devil May Cry' },
            { id: '2-s6', deck: 2, suit: 'spades', rank: '6', visual: 'ü™ù', title: 'Grapple', concept: 'Vertical mobility.', example: 'Spider-Man' },
            { id: '2-s7', deck: 2, suit: 'spades', rank: '7', visual: 'ü¶ñ', title: 'Tamer', concept: 'Capture enemies.', example: 'Palworld' },
            { id: '2-s8', deck: 2, suit: 'spades', rank: '8', visual: 'üëª', title: 'Possession', concept: 'Control enemies.', example: 'Mario Odyssey' },
            { id: '2-s9', deck: 2, suit: 'spades', rank: '9', visual: 'üßü', title: 'Horde', concept: 'Overwhelming numbers.', example: 'Days Gone' },
            { id: '2-s10', deck: 2, suit: 'spades', rank: '10', visual: '‚è±Ô∏è', title: 'Speedrun', concept: 'Optimization.', example: 'Neon White' },
            { id: '2-sj', deck: 2, suit: 'spades', rank: 'J', visual: 'üí∞', title: 'Heist', concept: 'Plan and execute.', example: 'Payday 2' },
            { id: '2-sq', deck: 2, suit: 'spades', rank: 'Q', visual: 'ü§∫', title: 'Duel', concept: '1v1 Spacing.', example: 'Nidhogg' },
            { id: '2-sk', deck: 2, suit: 'spades', rank: 'K', visual: 'üêú', title: 'Size Shift', concept: 'Scale mechanics.', example: 'Grounded' },
            { id: '2-sa', deck: 2, suit: 'spades', rank: 'A', visual: 'üåë', title: 'Shadow', concept: 'Light stealth.', example: 'Thief' },
            { id: '2-d2', deck: 2, suit: 'diamonds', rank: '2', visual: 'üîÑ', title: 'Roguelite', concept: 'Runs with upgrades.', example: 'Hades' },
            { id: '2-d3', deck: 2, suit: 'diamonds', rank: '3', visual: 'üé∞', title: 'Gacha', concept: 'Random rewards.', example: 'Genshin Impact' },
            { id: '2-d4', deck: 2, suit: 'diamonds', rank: '4', visual: 'üìà', title: 'Prestige', concept: 'Reset for power.', example: 'Cookie Clicker' },
            { id: '2-d5', deck: 2, suit: 'diamonds', rank: '5', visual: '‚õèÔ∏è', title: 'Crafting', concept: 'Gather > Craft.', example: 'Minecraft' },
            { id: '2-d6', deck: 2, suit: 'diamonds', rank: '6', visual: 'üíπ', title: 'Player Market', concept: 'Trading economy.', example: 'EVE Online' },
            { id: '2-d7', deck: 2, suit: 'diamonds', rank: '7', visual: 'ü¶ã', title: 'Collection', concept: 'Fill the museum.', example: 'Animal Crossing' },
            { id: '2-d8', deck: 2, suit: 'diamonds', rank: '8', visual: 'üéüÔ∏è', title: 'Battle Pass', concept: 'Seasonal tracks.', example: 'Fortnite' },
            { id: '2-d9', deck: 2, suit: 'diamonds', rank: '9', visual: '‚úèÔ∏è', title: 'Level Editor', concept: 'UGC Tools.', example: 'Mario Maker' },
            { id: '2-d10', deck: 2, suit: 'diamonds', rank: '10', visual: 'üìú', title: 'Wiki-Bait', concept: 'Obscure lore.', example: 'Tunic' },
            { id: '2-dj', deck: 2, suit: 'diamonds', rank: 'J', visual: 'üìä', title: 'Min-Max', concept: 'Deep stats.', example: 'Path of Exile' },
            { id: '2-dq', deck: 2, suit: 'diamonds', rank: 'Q', visual: 'üìÖ', title: 'Daily', concept: 'One challenge/day.', example: 'Wordle' },
            { id: '2-dk', deck: 2, suit: 'diamonds', rank: 'K', visual: 'üì∫', title: 'Episodic', concept: 'Released chapters.', example: 'Walking Dead' },
            { id: '2-da', deck: 2, suit: 'diamonds', rank: 'A', visual: 'üïµÔ∏è', title: 'ARG', concept: 'Reality blending.', example: 'Inscryption' },
            { id: '2-c2', deck: 2, suit: 'clubs', rank: '2', visual: 'üî•', title: 'Element', concept: 'Chemistry systems.', example: 'Breath of the Wild' },
            { id: '2-c3', deck: 2, suit: 'clubs', rank: '3', visual: 'üëΩ', title: 'Stalker AI', concept: 'Hunting enemy.', example: 'Alien: Isolation' },
            { id: '2-c4', deck: 2, suit: 'clubs', rank: '4', visual: 'üï≥Ô∏è', title: 'Deformable', concept: 'Digging terrain.', example: 'Deep Rock Galactic' },
            { id: '2-c5', deck: 2, suit: 'clubs', rank: '5', visual: 'üåä', title: 'Fluid', concept: 'Liquid physics.', example: 'Mario Sunshine' },
            { id: '2-c6', deck: 2, suit: 'clubs', rank: '6', visual: 'üåÄ', title: 'Portal', concept: 'Non-Euclidean.', example: 'Portal' },
            { id: '2-c7', deck: 2, suit: 'clubs', rank: '7', visual: 'üåó', title: 'Dual World', concept: 'Dimension swap.', example: 'Titanfall 2' },
            { id: '2-c8', deck: 2, suit: 'clubs', rank: '8', visual: 'üöõ', title: 'Vehicle Sim', concept: 'Driving physics.', example: 'SnowRunner' },
            { id: '2-c9', deck: 2, suit: 'clubs', rank: '9', visual: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', title: 'Crowd', concept: 'Social stealth.', example: 'Hitman' },
            { id: '2-c10', deck: 2, suit: 'clubs', rank: '10', visual: 'üöó', title: 'Soft Body', concept: 'Realistic crash.', example: 'BeamNG.drive' },
            { id: '2-cj', deck: 2, suit: 'clubs', rank: 'J', visual: 'üé§', title: 'Voice', concept: 'Mic input.', example: 'Lethal Company' },
            { id: '2-cq', deck: 2, suit: 'clubs', rank: 'Q', visual: 'üìç', title: 'GPS', concept: 'Location based.', example: 'Pokemon GO' },
            { id: '2-ck', deck: 2, suit: 'clubs', rank: 'K', visual: 'üß¨', title: 'Evolution', concept: 'Procedural life.', example: 'Spore' },
            { id: '2-ca', deck: 2, suit: 'clubs', rank: 'A', visual: 'üå™Ô∏è', title: 'Weather', concept: 'Dynamic storms.', example: 'Sea of Thieves' },
            { id: '2-joker', deck: 2, suit: 'joker', rank: '‚òÖ', visual: 'üìÄ', title: 'Remaster', concept: 'Modernize classic.', example: 'Resident Evil 4' },
        ];

        // DECK 3: Aesthetics (Art, Audio, Vibe)
        const DECK_3 = [
            // Hearts: Visual Style
            { id: '3-h2', deck: 3, suit: 'hearts', rank: '2', visual: 'üëæ', title: 'Pixel Art', concept: 'Retro nostalgia or modern crunch.', example: 'Celeste / Stardew Valley' },
            { id: '3-h3', deck: 3, suit: 'hearts', rank: '3', visual: 'üî≥', title: 'Low Poly', concept: 'PS1 era aesthetics.', example: 'Ultrakill / Deep Rock Galactic' },
            { id: '3-h4', deck: 3, suit: 'hearts', rank: '4', visual: 'üñåÔ∏è', title: 'Cel Shaded', concept: 'Living comic book.', example: 'Borderlands / Zelda: Wind Waker' },
            { id: '3-h5', deck: 3, suit: 'hearts', rank: '5', visual: 'üåö', title: 'Noir', concept: 'High contrast black & white.', example: 'Limbo / Return of the Obra Dinn' },
            { id: '3-h6', deck: 3, suit: 'hearts', rank: '6', visual: 'üé®', title: 'Hand-Drawn', concept: 'Traditional animation frames.', example: 'Cuphead / Hollow Knight' },
            { id: '3-h7', deck: 3, suit: 'hearts', rank: '7', visual: 'üåà', title: 'Psychedelic', concept: 'Sensory overload colors.', example: 'Hotline Miami / Cruelty Squad' },
            { id: '3-h8', deck: 3, suit: 'hearts', rank: '8', visual: 'üß±', title: 'Voxel', concept: '3D Pixel blocks.', example: 'Minecraft / Teardown' },
            { id: '3-h9', deck: 3, suit: 'hearts', rank: '9', visual: 'ü©∏', title: 'Gothic', concept: 'Dark, ornate, imposing.', example: 'Bloodborne / Darkest Dungeon' },
            { id: '3-h10', deck: 3, suit: 'hearts', rank: '10', visual: '‚¨ú', title: 'Minimalism', concept: 'Clean lines, flat colors.', example: 'Mini Metro / Superhot' },
            { id: '3-hj', deck: 3, suit: 'hearts', rank: 'J', visual: 'üñºÔ∏è', title: 'Watercolor', concept: 'Soft, painted edges.', example: 'Gris / Okami' },
            { id: '3-hq', deck: 3, suit: 'hearts', rank: 'Q', visual: 'üì∫', title: 'CRT Filter', concept: 'Analog signal decay.', example: 'Signalis / Balatro' },
            { id: '3-hk', deck: 3, suit: 'hearts', rank: 'K', visual: 'üóø', title: 'Claymation', concept: 'Stop-motion aesthetic.', example: 'Hylics / Neverhood' },
            { id: '3-ha', deck: 3, suit: 'hearts', rank: 'A', visual: 'üì∑', title: 'Photoreal', concept: 'Uncanny realism.', example: 'Unrecord / Hellblade II' },

            // Spades: Audio
            { id: '3-s2', deck: 3, suit: 'spades', rank: '2', visual: 'üéπ', title: 'Dynamic Music', concept: 'Music changes with action.', example: 'Doom Eternal / Metal Hellsinger' },
            { id: '3-s3', deck: 3, suit: 'spades', rank: '3', visual: 'üîá', title: 'Silence', concept: 'Absence of sound for tension.', example: 'Inside / Dark Souls' },
            { id: '3-s4', deck: 3, suit: 'spades', rank: '4', visual: 'üëæ', title: 'Chiptune', concept: '8-bit constraints.', example: 'Shovel Knight / Undertale' },
            { id: '3-s5', deck: 3, suit: 'spades', rank: '5', visual: 'üéª', title: 'Orchestral', concept: 'Epic cinematic score.', example: 'Elden Ring / Final Fantasy' },
            { id: '3-s6', deck: 3, suit: 'spades', rank: '6', visual: 'üéß', title: 'Binaural 3D', concept: 'Positional audio focus.', example: 'Hellblade / Hunt: Showdown' },
            { id: '3-s7', deck: 3, suit: 'spades', rank: '7', visual: 'üîä', title: 'Diegetic', concept: 'Sound comes from in-world.', example: 'Dead Space / Alien Isolation' },
            { id: '3-s8', deck: 3, suit: 'spades', rank: '8', visual: 'üó£Ô∏è', title: 'Narrator', concept: 'Voiceover reacts to play.', example: 'Bastion / Stanley Parable' },
            { id: '3-s9', deck: 3, suit: 'spades', rank: '9', visual: 'ü•Å', title: 'Rhythm Sync', concept: 'SFX match the beat.', example: 'Hi-Fi Rush / Rez' },
            { id: '3-s10', deck: 3, suit: 'spades', rank: '10', visual: 'ü§´', title: 'ASMR', concept: 'Satisfying clicks/whispers.', example: 'Unpacking / Potion Craft' },
            { id: '3-sj', deck: 3, suit: 'spades', rank: 'J', visual: 'üè≠', title: 'Industrial', concept: 'Grinding metal sounds.', example: 'Factorio / Silent Hill' },
            { id: '3-sq', deck: 3, suit: 'spades', rank: 'Q', visual: 'ü¶ó', title: 'Ambient', concept: 'Nature and atmosphere.', example: 'Breath of the Wild / Skyrim' },
            { id: '3-sk', deck: 3, suit: 'spades', rank: 'K', visual: 'üí•', title: 'Glitch', concept: 'Audio artifacts/distortion.', example: 'Cyberpunk 2077 / Pony Island' },
            { id: '3-sa', deck: 3, suit: 'spades', rank: 'A', visual: 'üé∏', title: 'Adaptive', concept: 'Instru. layers add up.', example: 'Nier Automata / Hades' },

            // Diamonds: Camera/View
            { id: '3-d2', deck: 3, suit: 'diamonds', rank: '2', visual: 'üëÄ', title: 'First Person', concept: 'Through the eyes.', example: 'Call of Duty / Portal' },
            { id: '3-d3', deck: 3, suit: 'diamonds', rank: '3', visual: 'üìê', title: 'Isometric', concept: '3/4 top-down view.', example: 'Hades / Disco Elysium' },
            { id: '3-d4', deck: 3, suit: 'diamonds', rank: '4', visual: 'üèÉ', title: 'Side Scroller', concept: '2D plane movement.', example: 'Mario / Hollow Knight' },
            { id: '3-d5', deck: 3, suit: 'diamonds', rank: '5', visual: 'üöÅ', title: 'Top-Down', concept: 'Bird\'s eye view.', example: 'Hotline Miami / Factorio' },
            { id: '3-d6', deck: 3, suit: 'diamonds', rank: '6', visual: 'üé•', title: 'Fixed Angle', concept: 'Cinematic specific frames.', example: 'Resident Evil 1 / God of War 3' },
            { id: '3-d7', deck: 3, suit: 'diamonds', rank: '7', visual: 'ü•Ω', title: 'VR', concept: 'Headset immersion.', example: 'Half-Life Alyx / Beat Saber' },
            { id: '3-d8', deck: 3, suit: 'diamonds', rank: '8', visual: 'üñ•Ô∏è', title: 'Second Person', concept: 'Watching a screen in-game.', example: 'Five Nights at Freddy\'s' },
            { id: '3-d9', deck: 3, suit: 'diamonds', rank: '9', visual: 'üìú', title: 'Text-Only', concept: 'Imagination driven.', example: 'Zork / A Dark Room' },
            { id: '3-d10', deck: 3, suit: 'diamonds', rank: '10', visual: 'ü™ü', title: 'Split Screen', concept: 'Simultaneous views.', example: 'It Takes Two / The Medium' },
            { id: '3-dj', deck: 3, suit: 'diamonds', rank: 'J', visual: 'üö´', title: 'UI-less', concept: 'Zero HUD immersion.', example: 'Dead Space / Journey' },
            { id: '3-dq', deck: 3, suit: 'diamonds', rank: 'Q', visual: 'üìπ', title: 'CCTV/Bodycam', concept: 'Grainy surveillance lens.', example: 'Observation / Content Warning' },
            { id: '3-dk', deck: 3, suit: 'diamonds', rank: 'K', visual: 'üêü', title: 'Fish-eye', concept: 'Distorted wide angle.', example: 'Cruelty Squad / Skate' },
            { id: '3-da', deck: 3, suit: 'diamonds', rank: 'A', visual: 'üì±', title: 'Portrait', concept: 'Vertical phone view.', example: 'Clash Royale / Downwell' },

            // Clubs: Vibe/Feel
            { id: '3-c2', deck: 3, suit: 'clubs', rank: '2', visual: '‚òï', title: 'Cozy', concept: 'Safe and warm.', example: 'Stardew / Animal Crossing' },
            { id: '3-c3', deck: 3, suit: 'clubs', rank: '3', visual: 'üò±', title: 'Horror', concept: 'Dread and panic.', example: 'Amnesia / Outlast' },
            { id: '3-c4', deck: 3, suit: 'clubs', rank: '4', visual: '‚ö°', title: 'Adrenaline', concept: 'High speed focus.', example: 'Doom / Burnout' },
            { id: '3-c5', deck: 3, suit: 'clubs', rank: '5', visual: 'üßò', title: 'Zen', concept: 'Flow state relaxation.', example: 'Tetris Effect / Flow' },
            { id: '3-c6', deck: 3, suit: 'clubs', rank: '6', visual: 'üò¢', title: 'Melancholy', concept: 'Sad but beautiful.', example: 'Gris / Shadow of the Colossus' },
            { id: '3-c7', deck: 3, suit: 'clubs', rank: '7', visual: 'üçå', title: 'Slapstick', concept: 'Goofy physicality.', example: 'Fall Guys / Goat Simulator' },
            { id: '3-c8', deck: 3, suit: 'clubs', rank: '8', visual: 'üè∞', title: 'Epic', concept: 'Grand scale grandeur.', example: 'Elden Ring / God of War' },
            { id: '3-c9', deck: 3, suit: 'clubs', rank: '9', visual: 'üì¶', title: 'Claustrophobic', concept: 'Tight, oppressive spaces.', example: 'Iron Lung / Metroid' },
            { id: '3-c10', deck: 3, suit: 'clubs', rank: '10', visual: 'üéûÔ∏è', title: 'Nostalgic', concept: 'Yearning for the past.', example: 'Shovel Knight / Stranger Things' },
            { id: '3-cj', deck: 3, suit: 'clubs', rank: 'J', visual: 'üçÑ', title: 'Surreal', concept: 'Dream logic weirdness.', example: 'Superliminal / Antichamber' },
            { id: '3-cq', deck: 3, suit: 'clubs', rank: 'Q', visual: 'ü™®', title: 'Gritty', concept: 'Dirty realism.', example: 'Last of Us / Gears of War' },
            { id: '3-ck', deck: 3, suit: 'clubs', rank: 'K', visual: 'üé†', title: 'Whimsical', concept: 'Playful imagination.', example: 'LittleBigPlanet / Psychonauts' },
            { id: '3-ca', deck: 3, suit: 'clubs', rank: 'A', visual: '‚ú®', title: 'Ethereal', concept: 'Otherworldly divine.', example: 'Journey / Child of Light' },

            // Joker
            { id: '3-joker', deck: 3, suit: 'joker', rank: '‚òÖ', visual: 'ü§°', title: 'Mascot', concept: 'Character-driven brand.', example: 'Mario / Sonic' },
        ];

        // DECK 4: World & Setting (Biomes, Eras, Factions)
        const DECK_4 = [
            // Hearts: Biomes
            { id: '4-h2', deck: 4, suit: 'hearts', rank: '2', visual: '‚òÅÔ∏è', title: 'Floating Isles', concept: 'Sky world archipelagos.', example: 'BioShock Infinite / Zelda: TotK' },
            { id: '4-h3', deck: 4, suit: 'hearts', rank: '3', visual: 'üåÜ', title: 'Cyber City', concept: 'Neon rain metropolis.', example: 'Cyberpunk 2077 / Stray' },
            { id: '4-h4', deck: 4, suit: 'hearts', rank: '4', visual: '‚ò¢Ô∏è', title: 'Post-Apoc', concept: 'Ruined civilization.', example: 'Fallout / Last of Us' },
            { id: '4-h5', deck: 4, suit: 'hearts', rank: '5', visual: 'ü¶ë', title: 'Deep Sea', concept: 'Underwater pressure.', example: 'Subnautica / Dave the Diver' },
            { id: '4-h6', deck: 4, suit: 'hearts', rank: '6', visual: 'üõ∞Ô∏è', title: 'Space Station', concept: 'Technological isolation.', example: 'Prey / Among Us' },
            { id: '4-h7', deck: 4, suit: 'hearts', rank: '7', visual: 'üï≥Ô∏è', title: 'Subterranean', concept: 'Underground networks.', example: 'Hollow Knight / Metro' },
            { id: '4-h8', deck: 4, suit: 'hearts', rank: '8', visual: 'üåå', title: 'Infinite Void', concept: 'Empty space/nothingness.', example: 'Outer Wilds / No Man\'s Sky' },
            { id: '4-h9', deck: 4, suit: 'hearts', rank: '9', visual: 'üå≥', title: 'Living Forest', concept: 'Nature is sentient.', example: 'Ori / Darkwood' },
            { id: '4-h10', deck: 4, suit: 'hearts', rank: '10', visual: 'üèúÔ∏è', title: 'Wasteland', concept: 'Harsh desert survival.', example: 'Mad Max / Journey' },
            { id: '4-hj', deck: 4, suit: 'hearts', rank: 'J', visual: '‚öôÔ∏è', title: 'Clockwork', concept: 'Inside a giant machine.', example: 'Dishonored 2 / Machinarium' },
            { id: '4-hq', deck: 4, suit: 'hearts', rank: 'Q', visual: 'üç¨', title: 'Candy Land', concept: 'Edible landscape.', example: 'Cuphead / Fall Guys' },
            { id: '4-hk', deck: 4, suit: 'hearts', rank: 'K', visual: 'üí§', title: 'Dreamscape', concept: 'Logic-defying mind.', example: 'Psychonauts / Omori' },
            { id: '4-ha', deck: 4, suit: 'hearts', rank: 'A', visual: 'üëæ', title: 'Glitch World', concept: 'Code is breaking down.', example: 'Axiom Verge / Pony Island' },

            // Spades: Eras/Tech
            { id: '4-s2', deck: 4, suit: 'spades', rank: '2', visual: 'üöÇ', title: 'Steampunk', concept: 'Brass and steam.', example: 'BioShock / Frostpunk' },
            { id: '4-s3', deck: 4, suit: 'spades', rank: '3', visual: 'ü¶¥', title: 'Stone Age', concept: 'Primal survival.', example: 'Far Cry Primal / Turok' },
            { id: '4-s4', deck: 4, suit: 'spades', rank: '4', visual: 'üöÄ', title: 'Far Future', concept: 'Type III civilization.', example: 'Halo / Mass Effect' },
            { id: '4-s5', deck: 4, suit: 'spades', rank: '5', visual: 'üìº', title: '1980s', concept: 'Neon retro nostalgia.', example: 'Hotline Miami / GTA Vice City' },
            { id: '4-s6', deck: 4, suit: 'spades', rank: '6', visual: 'üè∞', title: 'Medieval', concept: 'Swords and castles.', example: 'Witcher / Skyrim' },
            { id: '4-s7', deck: 4, suit: 'spades', rank: '7', visual: 'üèØ', title: 'Feudal Japan', concept: 'Samurai and mythology.', example: 'Sekiro / Ghost of Tsushima' },
            { id: '4-s8', deck: 4, suit: 'spades', rank: '8', visual: 'ü§†', title: 'Wild West', concept: 'Outlaws and frontiers.', example: 'Red Dead / Weird West' },
            { id: '4-s9', deck: 4, suit: 'spades', rank: '9', visual: 'üïµÔ∏è', title: 'Cold War', concept: 'Espionage and tension.', example: 'Metal Gear Solid 3 / CoD Black Ops' },
            { id: '4-s10', deck: 4, suit: 'spades', rank: '10', visual: '‚òÄÔ∏è', title: 'Solar Punk', concept: 'Green utopia technology.', example: 'Terra Nil / Overwatch' },
            { id: '4-sj', deck: 4, suit: 'spades', rank: 'J', visual: '‚õΩ', title: 'Dieselpunk', concept: 'Gritty combustion tech.', example: 'Wolfenstein / FF7 Midgar' },
            { id: '4-sq', deck: 4, suit: 'spades', rank: 'Q', visual: 'üè∫', title: 'Mythic Age', concept: 'Gods walk the earth.', example: 'God of War / Age of Mythology' },
            { id: '4-sk', deck: 4, suit: 'spades', rank: 'K', visual: 'üé©', title: 'Victorian', concept: 'Gaslight and cobblestone.', example: 'Bloodborne / Sherlock' },
            { id: '4-sa', deck: 4, suit: 'spades', rank: 'A', visual: 'üß†', title: 'Singularity', concept: 'AI transcendence.', example: 'System Shock / SOMA' },

            // Diamonds: Factions
            { id: '4-d2', deck: 4, suit: 'diamonds', rank: '2', visual: 'üß†', title: 'Hive Mind', concept: 'One shared consciousness.', example: 'The Flood (Halo) / Tyranids' },
            { id: '4-d3', deck: 4, suit: 'diamonds', rank: '3', visual: 'üè¢', title: 'Megacorp', concept: 'Profit over people.', example: 'Arasaka (Cyberpunk) / Shinra' },
            { id: '4-d4', deck: 4, suit: 'diamonds', rank: '4', visual: 'üïØÔ∏è', title: 'The Cult', concept: 'Fanatical devotion.', example: 'Far Cry 5 / Resident Evil 4' },
            { id: '4-d5', deck: 4, suit: 'diamonds', rank: '5', visual: '‚úä', title: 'Resistance', concept: 'Underdogs fighting back.', example: 'XCOM / Half-Life 2' },
            { id: '4-d6', deck: 4, suit: 'diamonds', rank: '6', visual: 'ü§ñ', title: 'AI Gods', concept: 'Machines rule man.', example: 'Matrix / Horizon Zero Dawn' },
            { id: '4-d7', deck: 4, suit: 'diamonds', rank: '7', visual: 'ü™ì', title: 'Barbarians', concept: 'Chaos and strength.', example: 'Mad Max / Warhammer Orks' },
            { id: '4-d8', deck: 4, suit: 'diamonds', rank: '8', visual: 'üéì', title: 'Academy', concept: 'Knowledge seekers.', example: 'Hogwarts / Fire Emblem' },
            { id: '4-d9', deck: 4, suit: 'diamonds', rank: '9', visual: 'üìú', title: 'The Guild', concept: 'Professional network.', example: 'Skyrim Thieves / Monster Hunter' },
            { id: '4-d10', deck: 4, suit: 'diamonds', rank: '10', visual: 'üëë', title: 'The Royals', concept: 'Decadent rulers.', example: 'Dishonored / Fable' },
            { id: '4-dj', deck: 4, suit: 'diamonds', rank: 'J', visual: 'üí∞', title: 'Bandits', concept: 'Lawless opportunists.', example: 'Borderlands / Fallout Raiders' },
            { id: '4-dq', deck: 4, suit: 'diamonds', rank: 'Q', visual: 'üèõÔ∏è', title: 'Ancients', concept: 'Precursor civilization.', example: 'Forerunners / Protheans' },
            { id: '4-dk', deck: 4, suit: 'diamonds', rank: 'K', visual: 'üß¨', title: 'Mutants', concept: 'Biologically altered.', example: 'X-Men / Fallout Ghouls' },
            { id: '4-da', deck: 4, suit: 'diamonds', rank: 'A', visual: 'ü¶æ', title: 'Cyborgs', concept: 'Man machine hybrids.', example: 'Deus Ex / Cyberpunk' },

            // Clubs: Plot Hooks
            { id: '4-c2', deck: 4, suit: 'clubs', rank: '2', visual: 'üìú', title: 'Prophecy', concept: 'Chosen one destiny.', example: 'Zelda / Morrowind' },
            { id: '4-c3', deck: 4, suit: 'clubs', rank: '3', visual: 'üíé', title: 'The Heist', concept: 'Steal the object.', example: 'GTA V / Payday' },
            { id: '4-c4', deck: 4, suit: 'clubs', rank: '4', visual: 'üèÉ', title: 'The Escape', concept: 'Get out alive.', example: 'Portal / Hades' },
            { id: '4-c5', deck: 4, suit: 'clubs', rank: '5', visual: 'üò°', title: 'Revenge', concept: 'Avenge the fallen.', example: 'God of War / Last of Us 2' },
            { id: '4-c6', deck: 4, suit: 'clubs', rank: '6', visual: 'üïµÔ∏è', title: 'Mystery', concept: 'Find the truth.', example: 'Outer Wilds / Her Story' },
            { id: '4-c7', deck: 4, suit: 'clubs', rank: '7', visual: 'üèÜ', title: 'Tournament', concept: 'Prove you are best.', example: 'Mortal Kombat / Unreal' },
            { id: '4-c8', deck: 4, suit: 'clubs', rank: '8', visual: 'üö©', title: 'Colonization', concept: 'Tame the wild.', example: 'Factorio / Rimworld' },
            { id: '4-c9', deck: 4, suit: 'clubs', rank: '9', visual: '‚õ∫', title: 'Survival', concept: 'Endure the elements.', example: 'The Long Dark / Don\'t Starve' },
            { id: '4-c10', deck: 4, suit: 'clubs', rank: '10', visual: '‚öîÔ∏è', title: 'The War', concept: 'Turn the tide.', example: 'Call of Duty / Helldivers' },
            { id: '4-cj', deck: 4, suit: 'clubs', rank: 'J', visual: 'üß≠', title: 'Discovery', concept: 'Map the unknown.', example: 'No Man\'s Sky / Subnautica' },
            { id: '4-cq', deck: 4, suit: 'clubs', rank: 'Q', visual: 'ü¶†', title: 'Corruption', concept: 'Stop the spread.', example: 'Terraria / Horizon' },
            { id: '4-ck', deck: 4, suit: 'clubs', rank: 'K', visual: 'üîÅ', title: 'The Loop', concept: 'Break the cycle.', example: 'Deathloop / Returnal' },
            { id: '4-ca', deck: 4, suit: 'clubs', rank: 'A', visual: 'üïØÔ∏è', title: 'Sacrifice', concept: 'Give up everything.', example: 'Dark Souls / Hellblade' },

            // Joker
            { id: '4-joker', deck: 4, suit: 'joker', rank: '‚òÖ', visual: 'üåç', title: 'Open World', concept: 'Go anywhere.', example: 'Breath of the Wild' },
        ];

        // --- App Logic ---
        const app = {
            state: {
                activeDecks: { 1: true, 2: false, 3: false, 4: false },
                currentDeck: [],
                drawIndex: 0,
                keptCards: [],
                view: 'draw',
                animating: false
            },

            init() {
                this.shuffleDecks();
                this.render();
                this.setupGestures();
            },

            shuffleDecks() {
                let combined = [];
                if (this.state.activeDecks[1]) combined = [...combined, ...DECK_1];
                if (this.state.activeDecks[2]) combined = [...combined, ...DECK_2];
                if (this.state.activeDecks[3]) combined = [...combined, ...DECK_3];
                if (this.state.activeDecks[4]) combined = [...combined, ...DECK_4];
                
                if(combined.length === 0) {
                    // Fallback to deck 1 if nothing selected to prevent crash
                    combined = [...DECK_1]; 
                    this.state.activeDecks[1] = true;
                }

                // Fisher-Yates shuffle
                for (let i = combined.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [combined[i], combined[j]] = [combined[j], combined[i]];
                }
                
                this.state.currentDeck = combined;
                this.state.drawIndex = 0;
            },

            toggleDeck(id) {
                const newActive = { ...this.state.activeDecks, [id]: !this.state.activeDecks[id] };
                // Prevent turning off all decks
                const hasActive = Object.values(newActive).some(val => val === true);
                if (!hasActive) return;

                this.state.activeDecks = newActive;
                this.shuffleDecks();
                this.render();
            },

            setView(viewName) {
                this.state.view = viewName;
                this.render();
            },

            discard() {
                if (this.state.animating) return;
                const cardEl = document.getElementById('card-wrapper').firstElementChild;
                if (cardEl) {
                    cardEl.classList.add('card-discard-left');
                    this.state.animating = true;
                    setTimeout(() => {
                        this.advanceDeck();
                        this.state.animating = false;
                        this.render();
                    }, 300);
                }
            },

            keep() {
                if (this.state.animating) return;
                const cardEl = document.getElementById('card-wrapper').firstElementChild;
                const currentCard = this.state.currentDeck[this.state.drawIndex];
                
                if (cardEl) {
                    cardEl.classList.add('card-keep-right');
                    this.state.animating = true;
                    
                    if (!this.state.keptCards.find(c => c.id === currentCard.id)) {
                        this.state.keptCards.push(currentCard);
                    }

                    setTimeout(() => {
                        this.advanceDeck();
                        this.state.animating = false;
                        this.render();
                    }, 300);
                }
            },
            
            reshuffle() {
                if(this.state.animating) return;
                const cardEl = document.getElementById('card-wrapper').firstElementChild;
                if(cardEl) cardEl.classList.add('card-reshuffle');
                this.state.animating = true;
                setTimeout(() => {
                    this.shuffleDecks();
                    this.state.animating = false;
                    this.render();
                }, 400);
            },

            advanceDeck() {
                if (this.state.drawIndex >= this.state.currentDeck.length - 1) {
                    this.shuffleDecks();
                } else {
                    this.state.drawIndex++;
                }
            },

            clearSaved() {
                this.state.keptCards = [];
                this.render();
            },

            removeSaved(cardId) {
                this.state.keptCards = this.state.keptCards.filter(c => c.id !== cardId);
                this.render();
            },

            // --- HTML Generators ---

            getSuitTheme(c) {
                if (c.deck === 1) {
                    if(c.suit === 'hearts') return "Experience";
                    if(c.suit === 'spades') return "Mechanics";
                    if(c.suit === 'diamonds') return "Dynamics";
                    if(c.suit === 'clubs') return "Innovation";
                }
                if (c.deck === 2) {
                    if(c.suit === 'hearts') return "Narrative";
                    if(c.suit === 'spades') return "Hardcore";
                    if(c.suit === 'diamonds') return "Loops";
                    if(c.suit === 'clubs') return "Tech";
                }
                if (c.deck === 3) {
                    if(c.suit === 'hearts') return "Visual Style";
                    if(c.suit === 'spades') return "Audio";
                    if(c.suit === 'diamonds') return "Camera/View";
                    if(c.suit === 'clubs') return "Vibe";
                }
                if (c.deck === 4) {
                    if(c.suit === 'hearts') return "Biome";
                    if(c.suit === 'spades') return "Era/Tech";
                    if(c.suit === 'diamonds') return "Faction";
                    if(c.suit === 'clubs') return "Plot Hook";
                }
                if(c.suit === 'joker') return "Wildcard";
                return "";
            },

            getDeckName(id) {
                if(id === 1) return "Creative Deck";
                if(id === 2) return "Mech Deck";
                if(id === 3) return "Aesthetic Deck";
                if(id === 4) return "World Deck";
                return "Unknown";
            },

            renderCardHTML(card, animate = false) {
                const isRed = ['hearts', 'diamonds', 'joker'].includes(card.suit);
                const textColor = isRed ? 'text-red-600' : 'text-slate-800';
                const borderColor = isRed ? 'border-red-200' : 'border-slate-200';
                const bgGradient = isRed ? 'from-red-50 to-white' : 'from-slate-50 to-white';
                
                let suitIcon = '';
                if(card.suit === 'hearts') suitIcon = 'heart';
                else if(card.suit === 'diamonds') suitIcon = 'diamond';
                else if(card.suit === 'clubs') suitIcon = 'club';
                else if(card.suit === 'spades') suitIcon = 'spade';
                else suitIcon = 'sparkles'; 

                const suitTheme = this.getSuitTheme(card);
                const deckName = this.getDeckName(card.deck);

                return `
                <div class="w-full h-full rounded-2xl shadow-2xl border-4 ${borderColor} bg-gradient-to-br ${bgGradient} flex flex-col p-4 relative overflow-hidden select-none bg-white ${animate ? 'card-enter' : ''}">
                    <!-- Deck Badge -->
                    <div class="absolute top-0 left-0 right-0 flex justify-center pt-2">
                        <span class="text-[9px] font-bold uppercase tracking-widest px-2 py-0.5 rounded-full bg-black/5 text-black/40">
                            ${deckName}
                        </span>
                    </div>

                    <!-- Top Rank -->
                    <div class="absolute top-4 left-4 flex flex-col items-center leading-none ${textColor}">
                        <span class="text-3xl font-bold font-serif">${card.rank}</span>
                        <i data-lucide="${suitIcon}" class="w-4 h-4 fill-current"></i>
                    </div>

                    <!-- Bottom Rank -->
                    <div class="absolute bottom-4 right-4 flex flex-col items-center leading-none ${textColor} transform rotate-180">
                        <span class="text-3xl font-bold font-serif">${card.rank}</span>
                        <i data-lucide="${suitIcon}" class="w-4 h-4 fill-current"></i>
                    </div>

                    <!-- Content -->
                    <div class="flex-1 flex flex-col items-center justify-center text-center mt-6 z-10">
                        <div class="text-6xl mb-2 drop-shadow-sm filter">${card.visual}</div>
                        <div class="text-[10px] uppercase font-bold tracking-widest opacity-60 mb-1 ${textColor}">${suitTheme}</div>
                        <h2 class="text-xl font-bold uppercase tracking-tight mb-1 ${textColor}">${card.title}</h2>
                        <div class="w-12 h-0.5 bg-black/10 mb-3"></div>
                        <p class="text-sm font-medium text-slate-600 mb-2 px-2 italic leading-relaxed">"${card.concept}"</p>
                        
                        <div class="mt-auto mb-16 bg-white/60 backdrop-blur-sm rounded-lg p-2 text-xs text-slate-500 border border-black/5 w-full">
                            <span class="font-bold block mb-0.5 text-slate-400 uppercase text-[9px]">Example</span>
                            <span class="text-slate-700 font-medium">${card.example}</span>
                        </div>
                    </div>
                </div>`;
            },

            // --- Render Logic ---
            render() {
                const content = document.getElementById('main-content');
                
                // Indicators
                document.querySelectorAll('.indicator').forEach(el => el.classList.add('hidden'));
                document.querySelectorAll('nav button').forEach(el => el.classList.remove('bg-indigo-600', 'text-white'));
                document.querySelectorAll('nav button i').forEach(el => el.classList.remove('text-indigo-400'));
                
                // Active Nav
                const activeNav = document.getElementById(`nav-${this.state.view}`);
                if(activeNav) {
                    activeNav.classList.add('bg-indigo-600', 'text-white');
                    activeNav.classList.remove('hover:bg-slate-800');
                }

                // Deck Buttons
                [1, 2, 3, 4].forEach(id => {
                    const btn = document.getElementById(`btn-deck-${id}`);
                    if(this.state.activeDecks[id]) {
                        btn.querySelector('.indicator').classList.remove('hidden');
                        btn.classList.add('bg-slate-800', 'border-indigo-500/50', 'text-indigo-300');
                    } else {
                        btn.classList.remove('bg-slate-800', 'border-indigo-500/50', 'text-indigo-300');
                    }
                });

                // Saved Count
                document.getElementById('saved-count').innerText = this.state.keptCards.length;

                // Views
                if (this.state.view === 'draw') {
                    const tpl = document.getElementById('tpl-draw');
                    content.innerHTML = tpl.innerHTML;
                    
                    const activeCount = Object.values(this.state.activeDecks).filter(Boolean).length;
                    const deckLabel = activeCount > 1 ? `Combined Deck (${activeCount})` : 'Single Deck';
                    
                    document.getElementById('deck-label').innerText = deckLabel;
                    document.getElementById('card-counter').innerText = `Card ${this.state.drawIndex + 1} of ${this.state.currentDeck.length}`;

                    const wrapper = document.getElementById('card-wrapper');
                    const currentCard = this.state.currentDeck[this.state.drawIndex];
                    wrapper.innerHTML = this.renderCardHTML(currentCard, true); 
                    
                    this.setupGestures();

                } else if (this.state.view === 'saved') {
                    const tpl = document.getElementById('tpl-saved');
                    content.innerHTML = tpl.innerHTML;
                    
                    const grid = document.getElementById('saved-grid');
                    if (this.state.keptCards.length === 0) {
                        document.getElementById('empty-state').classList.remove('hidden');
                        grid.classList.add('hidden');
                    } else {
                        grid.innerHTML = this.state.keptCards.map(card => `
                            <div class="bg-white rounded-xl p-4 shadow-sm border border-slate-200 flex items-start space-x-4 relative overflow-hidden">
                                <div class="absolute top-0 left-0 bg-slate-100 text-[8px] px-2 font-bold uppercase text-slate-400">${this.getDeckName(card.deck)}</div>
                                <div class="text-4xl bg-slate-50 p-2 rounded-lg border border-slate-100 mt-2">${card.visual}</div>
                                <div class="mt-2">
                                    <h3 class="font-bold text-slate-800">${card.title}</h3>
                                    <p class="text-xs text-slate-500 uppercase tracking-wide mb-1">${card.concept}</p>
                                    <p class="text-sm text-slate-600 leading-snug">"${card.example}"</p>
                                    <button onclick="app.removeSaved('${card.id}')" class="text-xs text-red-400 hover:text-red-600 mt-2 flex items-center">
                                        Remove
                                    </button>
                                </div>
                            </div>
                        `).join('');
                    }

                } else if (this.state.view === 'gallery') {
                    const tpl = document.getElementById('tpl-gallery');
                    content.innerHTML = tpl.innerHTML;
                    const galleryContent = document.getElementById('gallery-content');
                    
                    const suits = ['hearts', 'spades', 'diamonds', 'clubs', 'joker'];
                    const suitLabels = { hearts: 'Hearts', spades: 'Spades', diamonds: 'Diamonds', clubs: 'Clubs', joker: 'Jokers' };
                    
                    let html = '';
                    suits.forEach(suit => {
                        const cards = this.state.currentDeck.filter(c => c.suit === suit)
                            .sort((a,b) => {
                                const order = ['2','3','4','5','6','7','8','9','10','J','Q','K','A','‚òÖ'];
                                return order.indexOf(a.rank) - order.indexOf(b.rank);
                            });
                        
                        if(cards.length === 0) return;

                        const isRed = ['hearts', 'diamonds', 'joker'].includes(suit);
                        const colorClass = isRed ? 'text-red-600' : 'text-slate-700';
                        const iconColor = isRed ? 'text-red-500' : 'text-slate-700';
                        let suitIcon = '';
                        if(suit === 'hearts') suitIcon = 'heart';
                        else if(suit === 'diamonds') suitIcon = 'diamond';
                        else if(suit === 'clubs') suitIcon = 'club';
                        else if(suit === 'spades') suitIcon = 'spade';
                        else suitIcon = 'sparkles';

                        html += `
                        <div class="mb-10">
                            <div class="flex items-center space-x-2 border-b ${isRed ? 'border-red-200' : 'border-slate-200'} pb-2 mb-4">
                                <i data-lucide="${suitIcon}" class="${iconColor} w-4 h-4 fill-current"></i>
                                <h3 class="text-lg font-bold uppercase tracking-wider ${colorClass}">${suitLabels[suit]}</h3>
                                <span class="text-xs text-slate-400 ml-auto font-mono bg-slate-100 px-2 py-0.5 rounded-full">${cards.length} Cards</span>
                            </div>
                            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                                ${cards.map(c => `
                                    <div class="bg-white rounded-lg p-3 shadow-sm border border-slate-200 hover:border-indigo-300 transition-colors flex flex-col items-center text-center relative overflow-hidden group">
                                        <div class="absolute top-1 right-2 text-[8px] font-bold uppercase text-slate-300">${c.deck === 1 ? 'CREATIVE' : c.deck === 2 ? 'MECH' : c.deck === 3 ? 'ART' : 'WORLD'}</div>
                                        <div class="text-2xl mb-1 z-10">${c.visual}</div>
                                        <div class="text-xs font-bold uppercase z-10 ${colorClass}">${c.rank}</div>
                                        <div class="font-bold text-slate-800 text-sm leading-tight mt-1 z-10">${c.title}</div>
                                        <div class="text-[10px] text-slate-500 mt-1 z-10 opacity-80 line-clamp-2">${c.concept}</div>
                                        <div class="absolute top-0 right-0 p-1 opacity-10 group-hover:opacity-20 ${iconColor}">
                                            <i data-lucide="${suitIcon}" class="w-10 h-10 fill-current"></i>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>`;
                    });
                    
                    galleryContent.innerHTML = html;
                }

                lucide.createIcons();
            },

            // --- Gestures ---
            setupGestures() {
                const wrapper = document.getElementById('card-wrapper');
                if(!wrapper) return;

                wrapper.addEventListener('touchstart', (e) => {
                    this.touchEnd = null;
                    this.touchStart = { x: e.targetTouches[0].clientX, y: e.targetTouches[0].clientY };
                });

                wrapper.addEventListener('touchmove', (e) => {
                    this.touchEnd = { x: e.targetTouches[0].clientX, y: e.targetTouches[0].clientY };
                });

                wrapper.addEventListener('touchend', () => {
                    if (!this.touchStart || !this.touchEnd) return;
                    const distanceX = this.touchStart.x - this.touchEnd.x;
                    const distanceY = this.touchStart.y - this.touchEnd.y;
                    const isHorizontal = Math.abs(distanceX) > Math.abs(distanceY);
                    const minSwipe = 50;

                    if (isHorizontal) {
                        if (distanceX > minSwipe) this.discard(); // Swipe Left
                        else if (distanceX < -minSwipe) this.keep(); // Swipe Right
                    } else {
                        if (distanceY < -minSwipe) this.reshuffle(); // Pull Down
                    }
                });
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>
